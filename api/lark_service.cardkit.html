

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lark_service.cardkit package &mdash; Lark Service 0.2.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=ad3000b3"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Lark Service
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">快速开始</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Lark Service - 项目文档索引</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id1">🎯 快速导航</a></li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id2">📚 核心文档 (25+)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id3">1. 产品与规格 (4个)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#api-5">2. 架构与API (5个)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id4">3. 开发指南 (6个)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id5">4. 部署与配置 (6个)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id6">5. 功能特性 (2个) 🆕</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id7">6. 技术专题 (3个)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id8">7. 发布说明 (1个) 🆕</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id9">📊 项目状态与报告</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#v0-5-0">当前状态 (v0.5.0) 🎉</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id10">检查清单</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id11">历史归档</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id12">🔧 模块使用说明</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#core">Core 核心模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#messaging">Messaging 消息模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#clouddoc">CloudDoc 云文档模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#contact">Contact 通讯录模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#cardkit">CardKit 卡片模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#apaas">aPaaS 数据空间模块</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id13">📖 快速开始</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id14">1. 查看项目概览</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id15">2. 本地开发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id16">3. 代码质量检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#git">4. Git工作流</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id17">📋 项目规范</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id18">代码规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id19">Git规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id20">质量门禁</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id21">🔍 相关资源</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id22">官方文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id23">项目链接</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id24">项目指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../README.html#id25">📞 获取帮助</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id26">问题排查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../README.html#id27">文档导航</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">安装指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id2">环境要求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#pip">使用 pip 安装</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id3">开发环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id4">生产环境</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#docker">使用 Docker 部署</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id5">1. 克隆项目</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id6">2. 配置环境变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id7">3. 启动服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id8">4. 运行数据库迁移</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id9">5. 配置飞书应用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id10">验证安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id11">下一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">5分钟快速开始</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id2">前置条件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id3">步骤 1: 安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id4">步骤 2: 配置环境变量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id5">步骤 3: 初始化数据库</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id6">步骤 4: 添加飞书应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id7">步骤 5: 发送第一条消息</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id8">步骤 6: 发送交互式卡片</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id9">🎉 完成！</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id10">下一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id11">常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#q-open-id">Q: 如何获取用户的 open_id？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#q-token">Q: 如何处理 token 过期？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#q">Q: 如何启用日志？</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference.html">代码质量检查工具快速参考</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id2">🎯 核心命令</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#id3">日常开发流程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#id4">辅助命令</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id5">📋 检查内容详解</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#git-check">git check 会运行以下检查：</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#id6">关键配置差异</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id7">⚙️ 配置文件对应关系</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id8">🔧 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#q1-mypy-commit">Q1: 为什么本地 mypy 通过，但 commit 失败？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#q2-tests">Q2: tests/ 的类型注解错误要修复吗？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick-reference.html#q3">Q3: 如何只检查特定目录？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id9">📖 完整工作流示例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id10">🚀 首次设置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-reference.html#id11">📚 更多信息</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">使用指南</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/app-management.html">应用管理 (Application Management)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id1">概述</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id2">核心概念</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#app-id">5层 app_id 解析优先级</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id3">场景 1: 单应用场景</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id4">示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id5">返回值示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id6">场景 2: 多应用场景 - 客户端级别默认值</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id7">示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id8">返回值示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id9">场景 3: 动态切换应用 - 使用上下文管理器</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id10">示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id11">输出示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id12">场景 4: 方法参数覆盖 - 最高优先级</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id13">示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id14">返回值示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id15">场景 5: 嵌套上下文管理器</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id16">示例代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id17">输出示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id18">实用工具方法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id">获取当前应用 ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id19">列出所有可用应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id20">输出示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id21">错误处理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id22">未指定 app_id</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id23">应用不存在</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id24">线程安全注意事项</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id25">推荐做法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/app-management.html#id26">示例代码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id27">最佳实践</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/app-management.html#id28">相关文档</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/messaging.html">消息服务</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/messaging.html#id2">基本用法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/messaging.html#id3">应用管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/messaging.html#id4">快速示例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/card.html">卡片服务</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id2">功能特点</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id3">快速开始</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id4">基础使用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id5">预定义卡片模板</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#notification-card">1. 通知卡片 (Notification Card)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#approval-card">2. 审批卡片 (Approval Card)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#form-card">3. 表单卡片 (Form Card)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id6">自定义卡片构建</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#build-card">使用 build_card 方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id7">常用卡片元素</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/card.html#div">文本元素 (div)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/card.html#markdown">Markdown 文本</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/card.html#button">按钮 (button)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/card.html#hr">分割线 (hr)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/card.html#img">图片 (img)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/card.html#column-set">多列布局 (column_set)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id8">卡片交互回调</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id9">设置回调服务器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id10">卡片回调数据结构</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id11">更新卡片</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#cardupdater">使用 CardUpdater</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id12">在回调中更新卡片</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id13">高级用法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id14">条件渲染</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id15">数据绑定</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id16">卡片链</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id17">最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id18">1. 卡片设计原则</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id19">2. 错误处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id20">3. 回调安全验证</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id21">4. 性能优化</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id22">故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id23">卡片发送失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/card.html#id24">回调未触发</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/card.html#id25">相关文档</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/contact.html">通讯录服务</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/contact.html#id2">应用管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/contact.html#id3">快速示例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/clouddoc.html">云文档服务</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/clouddoc.html#id2">应用管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/clouddoc.html#id3">快速示例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/apaas.html">aPaaS 数据空间</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/apaas.html#id1">应用管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/apaas.html#id2">快速示例</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/auth.html">WebSocket 用户授权</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id1">概述</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id2">核心特性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id3">授权流程</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id4">前置条件</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id5">1. 数据库配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id6">2. 飞书应用配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id7">3. 环境变量</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id8">基本用法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id9">初始化组件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id10">发送授权卡片</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id11">检查授权状态</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#user-access-token">使用 user_access_token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id12">高级用法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id13">自定义授权卡片</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#token">Token 自动刷新</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id14">会话管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id15">清理过期会话</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id16">WebSocket 事件处理（可选）</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id17">生产部署注意事项</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id18">1. 公网访问要求</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/auth.html#id19">开发环境方案</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/auth.html#id20">生产环境方案</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id21">2. 回调服务器配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#oauth-redirect-uri">3. 配置 OAuth Redirect URI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id22">4. 环境变量</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id23">错误处理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id24">常见错误</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/auth.html#id25">1. 授权码过期</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/auth.html#id26">2. Token 刷新失败</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/auth.html#id27">3. 会话不存在</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id28">监控指标</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id29">完整示例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id30">限制与注意事项</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id31">⚠️ 公网要求</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id32">⚠️ 授权流程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/auth.html#id33">⚠️ Token 管理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#id34">相关文档</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/auth.html#api">API 参考</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/scheduler.html">Scheduler 定时任务</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id1">功能特点</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id2">快速开始</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id3">基础用法</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id4">使用预定义任务</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id5">预定义任务</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#sync-user-info">1. 用户信息同步 (<code class="docutils literal notranslate"><span class="pre">sync_user_info</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#token-check-token-expiry">2. Token 过期检查 (<code class="docutils literal notranslate"><span class="pre">check_token_expiry</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#token-cleanup-expired-tokens">3. 过期 Token 清理 (<code class="docutils literal notranslate"><span class="pre">cleanup_expired_tokens</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#scheduler-health-check">4. 健康检查 (<code class="docutils literal notranslate"><span class="pre">scheduler_health_check</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id6">自定义任务</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id7">创建自定义任务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#interval-job">Interval Job 选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#cron-job">Cron Job 表达式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id8">任务管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id9">查看所有任务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id10">移除任务</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#docker">Docker 中运行</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#prometheus">Prometheus 监控</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id11">任务执行计数器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id12">任务执行时长</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#grafana">Grafana 查询示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id13">最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id14">1. 错误处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id15">2. 超时控制</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id16">3. 幂等性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id17">4. 分布式锁</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id18">故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id19">任务未执行</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/scheduler.html#id20">任务执行失败</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/scheduler.html#id21">下一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage/advanced.html">高级用法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id2">目录</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id3">多应用管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id4">动态应用切换策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id5">多服务客户端协同</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id6">自定义重试策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id7">批量操作优化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id8">批量发送消息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#apaas">批量创建aPaaS记录</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id9">错误处理最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id10">分级错误处理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id11">日志配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id12">自定义日志级别</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id13">性能优化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#token">Token缓存</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id14">连接池复用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id15">安全最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id16">敏感信息保护</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id17">数据库文件权限</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/advanced.html#id18">Token过期处理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usage/advanced.html#id19">相关文档</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API 参考</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api-examples.html">API使用示例</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api-examples.html#id1">快速开始</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-examples.html#id2">消息发送示例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id3">发送文本消息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id4">发送富文本消息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id5">发送卡片消息</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-examples.html#id6">通讯录操作示例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id7">获取用户信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id8">查询部门信息</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-examples.html#id9">云文档操作示例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id10">操作电子表格</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id11">操作多维表格</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-examples.html#id12">完整应用示例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-examples.html#id13">消息通知机器人</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api-rate-limiting-guide.html">API速率限制配置指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id1">📋 概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id2">🎯 限流策略</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#fixed-window">1. 固定窗口（Fixed Window）</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#sliding-window">2. 滑动窗口（Sliding Window）</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#token-bucket">3. 令牌桶（Token Bucket）</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id3">⚙️ 配置方法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id4">环境变量配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id5">代码配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#fastapi">FastAPI中间件集成</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id6">📊 预定义限流配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id7">🔍 响应头</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#too-many-requests">429 Too Many Requests响应</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id8">🧪 测试速率限制</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id9">单元测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id10">压力测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id11">手动测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id12">📈 监控指标</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#grafana">Grafana告警</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id13">🎯 最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id14">1. 选择合适的限流策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id15">2. 合理设置限额</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id16">3. 提供清晰的错误信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id17">4. 客户端重试策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id18">5. 用户标识</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id19">⚠️ 注意事项</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id20">分布式部署</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id21">白名单</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id22">成本考虑</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id23">🔧 故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id24">问题1: 频繁触发限流</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id25">问题2: 限流不生效</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api-rate-limiting-guide.html#id26">问题3: 性能影响</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-rate-limiting-guide.html#id27">📚 参考资料</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="core.html">核心模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auth.html">认证模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="messaging.html">消息模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">通讯录模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clouddoc.html">云文档模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apaas.html">aPaaS 模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">事件模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scheduler.html">调度模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="services.html">服务模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">监控模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server.html">服务器模块</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">工具模块</a><ul class="simple">
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">部署与运维</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html">LarkService 生产环境部署指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id1">目录</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id2">系统要求</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id3">硬件要求</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id4">软件要求</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id5">前置准备</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#docker-docker-compose">1. 安装 Docker 和 Docker Compose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id6">2. 获取代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id7">3. 配置飞书应用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id8">环境配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id9">1. 创建环境变量文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#env">2. 编辑 <code class="docutils literal notranslate"><span class="pre">.env</span></code> 文件</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id10">基础配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id11">飞书应用配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id12">数据库配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#rabbitmq">RabbitMQ 配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id13">监控配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#token">Token 监控配置</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id14">部署步骤</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id15">1. 构建镜像</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id16">2. 启动服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id17">3. 验证部署</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id18">检查服务健康状态</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id19">验证数据库连接</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id20">验证 RabbitMQ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id21">监控配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#prometheus">1. Prometheus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#grafana">2. Grafana</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id22">访问 Grafana</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id23">导入仪表板</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id24">导入步骤</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id25">3. 告警规则</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id26">运维管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id27">日常维护</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id28">查看日志</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id29">重启服务</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id30">更新服务</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id31">数据备份</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#postgresql">PostgreSQL 备份</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id32">恢复备份</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id33">日志轮转</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id34">故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id35">常见问题</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id36">1. 服务无法启动</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id37">2. Token 刷新失败</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id38">3. 数据库连接失败</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id39">4. Prometheus 无法抓取指标</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id40">性能优化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id41">数据库优化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id42">Token 缓存优化</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id43">安全加固</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id44">1. 网络隔离</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#https">2. 使用 HTTPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id45">3. 密钥管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id46">4. 最小权限原则</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id47">扩展部署</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id48">高可用部署</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id49">多实例部署</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id50">负载均衡</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#kubernetes">Kubernetes 部署</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id51">联系与支持</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#id52">附录</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#a">A. 端口列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#b">B. 环境变量完整列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/PRODUCTION_DEPLOYMENT.html#c-docker-compose">C. Docker Compose 服务依赖图</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">部署指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id2">快速链接</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id3">2. 依赖服务部署</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#postgresql">2.1 PostgreSQL 部署</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#docker">本地开发 (Docker)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#id4">生产环境 (云服务)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#fr-118-new">数据备份与恢复 (FR-118) ⭐ NEW</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#rabbitmq">2.2 RabbitMQ 部署</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#id5">本地开发 (Docker)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#id6">生产环境 (云服务)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#docker-compose">2.3 Docker Compose 一键部署</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id7">3. 集成方式选择</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id8">3.1 子项目集成 (推荐) ⭐</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#pypi">3.2 PyPI 包安装 (备选)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id9">3.3 集成方式对比</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id10">4. 在不同应用中使用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#django">4.1 Django 应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#flask">4.2 Flask 应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#apache-airflow">4.3 Apache Airflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#fastapi">4.4 FastAPI 应用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id11">5. 环境变量配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id12">5.1 必需环境变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id13">5.2 生成加密密钥</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id14">5.3 不同环境的配置管理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#id15">开发环境</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#id16">测试环境</a></li>
<li class="toctree-l4"><a class="reference internal" href="../deployment.html#id17">生产环境</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id18">6. 初始化应用配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#cli">5.1 使用 CLI 添加应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#python-api">5.2 使用 Python API 添加应用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id19">7. 数据库迁移</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#alembic">6.1 初始化 Alembic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id20">6.2 执行迁移</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id21">6.3 创建新迁移</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id22">8. 健康检查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id23">7.1 数据库连接检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id24">7.2 RabbitMQ 连接检查</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id25">9. 监控和日志</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id26">8.1 日志配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id27">8.2 监控指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id28">10. 安全最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id29">9.1 密钥管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id30">9.2 网络安全</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id31">9.3 数据库安全</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id32">10. 故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id33">10.1 常见问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id34">10.2 调试模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id35">10.3 查看日志</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id36">11. 性能优化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id37">11.1 数据库优化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id38">11.2 连接池配置</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment.html#id39">12. 备份和恢复</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id40">12.1 备份策略概览</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id41">12.2 自动化备份脚本</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id42">12.3 PostgreSQL 备份</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#sqlite">12.4 SQLite 配置备份</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id43">12.5 数据库迁移回滚</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id44">12.6 备份验证</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment.html#id45">12.7 灾难恢复演练</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring.html">监控指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#prometheus">Prometheus 监控</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#id2">关键指标</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#websocket">WebSocket 连接</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#id3">授权流程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#token">Token 管理</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../observability-guide.html">可观测性与监控指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability-guide.html#id2">📊 可观测性目标</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id3">三大支柱</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../observability-guide.html#chk088-chk089">📝 日志规范 (CHK088, CHK089)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id4">日志格式标准</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#chk088">构建日志规范 (CHK088)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#chk089">配置加载日志 (CHK089)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id5">关键操作日志</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../observability-guide.html#chk030-chk090">📈 健康检查 (CHK030, CHK090)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#chk030">健康检查响应时间阈值 (CHK030)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id6">健康检查端点实现</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#chk090">监控指标 (CHK090)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#kubernetes">Kubernetes 健康检查配置</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../observability-guide.html#grafana">📊 Grafana 仪表盘</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id7">推荐仪表盘</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id8">告警规则</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../observability-guide.html#id9">✅ 可观测性检查清单</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id10">日志检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id11">指标检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id12">健康检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability-guide.html#id13">告警检查</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../grafana-setup-guide.html">Grafana配置指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#id1">1. 访问Grafana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#prometheus">2. 配置Prometheus数据源</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id2">步骤 1: 添加数据源</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id3">步骤 2: 配置参数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id4">步骤 3: 保存并测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#lark-service">3. 导入Lark Service监控仪表板</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id5">方法 1: 从文件导入</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#json">方法 2: 直接粘贴JSON</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#id6">4. 仪表板内容</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#http">HTTP性能</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#token">Token管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#api">API调用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id7">系统资源</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id8">业务指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#id9">5. 告警配置（可选）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id10">创建告警规则</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id11">推荐告警</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#id12">6. 自定义面板</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id13">添加新面板</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#promql">常用PromQL查询</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#id14">7. 故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id15">问题: 仪表板无数据</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana-setup-guide.html#id16">问题: 指标值为0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grafana-setup-guide.html#id17">8. 相关链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tracing-guide.html">分布式追踪配置指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id2">📋 概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id3">🎯 追踪策略</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#request-id">Request ID 规范</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id4">🔧 实现方案</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id5">1. Request ID 生成器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#fastapi">2. FastAPI 中间件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id6">3. 异步任务追踪</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id7">4. 飞书回调追踪</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id8">📊 追踪字段标准</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id9">日志必需字段</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id10">跨服务传递</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id11">🔍 追踪查询</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#elasticsearch-kibana">Elasticsearch/Kibana 查询</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#grafana-loki">Grafana Loki 查询</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#postgresql">PostgreSQL 慢查询关联</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id12">📈 追踪指标</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#prometheus-metrics">Prometheus Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id13">🚀 最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id14">1. 始终传播 request_id</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id15">2. 异步任务包含原始 request_id</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id16">3. 错误日志包含完整上下文</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing-guide.html#id17">4. 性能追踪</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tracing-guide.html#id18">🔗 相关文档</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">故障排查</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#id2">常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#id3">数据库连接失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#token">Token 获取失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#oauth">OAuth 回调失败</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../error-codes.html">错误码文档</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html#xxx">系统错误码 (1xxx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html#token-2xxx">Token错误码 (2xxx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html#api-3xxx">API错误码 (3xxx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html#api-99991xxx">飞书API错误码 (99991xxx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html#id2">业务错误码 (4xxx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html#id3">使用示例</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../error-handling-guide.html">异常处理与恢复策略指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../error-handling-guide.html#id2">核心原则</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-handling-guide.html#chk052">启动失败处理 (CHK052)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#id3">退出码规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#id4">配置加载失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#id5">数据库连接失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#id6">服务降级策略</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-handling-guide.html#chk058">数据库初始化回滚 (CHK058)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#alembic">Alembic 迁移失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#sqlite">SQLite 初始化失败</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-handling-guide.html#id7">运行时错误处理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#api">API 调用错误</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-handling-guide.html#id8">数据库错误</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-handling-guide.html#id9">自动恢复场景</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-handling-guide.html#id10">检查清单</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../error-recovery-guide.html">错误恢复指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id2">目录</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#token">Token相关错误</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#token-99991663">错误1: Token过期 (99991663)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id3">错误2: 凭据无效 (99991400/99991401)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id4">数据库连接错误</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id5">错误3: 数据库连接失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id6">错误4: 数据库死锁</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#api">API调用错误</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#api-99991405">错误5: API限流 (99991405)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id7">错误6: 网络超时</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id8">缓存错误</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#redis">错误7: Redis连接失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id9">错误8: 缓存雪崩</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id10">配置错误</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id11">错误9: 环境变量缺失</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id12">消息队列错误</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#rabbitmq">错误10: RabbitMQ连接失败</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id13">通用恢复策略</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id14">1. 健康检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id15">2. 日志分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id16">3. 监控告警</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id17">4. 回滚策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../error-recovery-guide.html#id18">5. 紧急联系</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id19">最佳实践</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-recovery-guide.html#id20">相关文档</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security-guide.html">安全配置指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#blocker">🚨 安全需求清单 (Blocker)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#must">配置安全 (MUST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id2">密钥管理 (MUST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id3">依赖安全 (MUST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id4">容器安全 (MUST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id5">环境隔离 (MUST)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id6">🔐 加密密钥管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id7">密钥作用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id8">为什么需要加密?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id9">🚀 部署配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id10">开发环境</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#id11">1. 生成加密密钥</a></li>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#env">2. 配置 .env 文件</a></li>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#id12">3. 重要提醒</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id13">生产环境</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#a">方案 A: 系统环境变量 (推荐)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#b-docker-secrets">方案 B: Docker Secrets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#c-kubernetes-secrets">方案 C: Kubernetes Secrets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../security-guide.html#d">方案 D: 云服务密钥管理</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id14">🔄 密钥轮换</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id15">何时需要轮换密钥?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id16">轮换步骤</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id17">📁 文件权限管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#sqlite-fr-079-fr-080">SQLite 配置文件权限 (FR-079, FR-080)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#env-fr-094">生产环境 .env 文件权限 (FR-094)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#fr-081">🔖 配置敏感度分类 (FR-081)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#public">Public (公开级)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#internal">Internal (内部级)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#secret">Secret (机密级)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#fr-084">日志脱敏规则 (FR-084)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id18">🛡️ 依赖安全管理</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#fr-086">安全扫描工具 (FR-086)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#fr-087">依赖更新策略 (FR-087)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#fr-088">依赖版本锁定 (FR-088)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id19">🐳 容器安全</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#docker-fr-089-fr-091">Docker 镜像最佳实践 (FR-089, FR-091)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#fr-090">镜像安全扫描 (FR-090)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#ci-cd">CI/CD 集成示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id20">🔄 密钥轮换流程</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#cli-fr-083">CLI 密钥轮换命令 (FR-083)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id21">轮换频率建议</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id22">✅ 安全检查清单</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id23">开发环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id24">生产环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#id25">数据库</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id26">🔍 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#q1">Q1: 如果忘记了加密密钥怎么办?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#q2-123456">Q2: 可以使用弱密钥吗 (如 &quot;123456&quot;)?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#q3">Q3: 多个环境可以共用一个密钥吗?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#q4">Q4: 数据库文件可以直接复制到其他环境吗?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security-guide.html#q5">Q5: 如何验证密钥是否正确?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security-guide.html#id27">📚 相关文档</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">架构与设计</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../architecture/token-refresh-mechanism.html">飞书 Token 刷新机制详解</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id1">📋 概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id2">🔑 Token 类型</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#app-access-token">1. App Access Token (应用级访问令牌)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#tenant-access-token">2. Tenant Access Token (租户级访问令牌)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#user-access-token">3. User Access Token (用户级访问令牌)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id3">🔄 Token 类型对比总结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id4">🚨 常见误区</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#token-app-secret">❌ 误区 1: Token 过期就需要重新生成 app_secret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id5">❌ 误区 2: 所有 Token 都需要监控过期</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id6">❌ 误区 3: Token 刷新失败就是 app_secret 的问题</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id7">📊 监控和通知策略</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#app-access-token-tenant-access-token">App Access Token / Tenant Access Token</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id8">User Access Token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#larkservice">🔧 LarkService 实现细节</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#credentialpool">CredentialPool 自动刷新逻辑</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#tokenexpirymonitor">TokenExpiryMonitor 智能通知</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id9">🎯 最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id10">1. 定期任务配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id11">2. 通知内容模板</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#refresh-token-7">Refresh Token 7 天预警</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#refresh-token-3">Refresh Token 3 天严重警告</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#refresh-token">Refresh Token 已过期</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id12">📚 参考资料</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/token-refresh-mechanism.html#id13">🤝 感谢</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Lark Service 架构设计文档</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id1">1. 系统概述</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id2">1.1 设计目标</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id3">1.2 核心特性</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id4">2. 系统架构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id5">2.1 完整系统架构图</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id6">2.2 数据流图</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../architecture.html#id7">2.2.1 发送消息流程</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture.html#id8">2.2.2 用户查询流程 (带缓存)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../architecture.html#token">2.2.3 Token 自动刷新流程</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id9">2.3 模块依赖关系</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id10">3. Token 管理架构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id11">3.1 Token 生命周期</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id12">3.2 并发控制</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id13">5. 安全架构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id14">5.1 加密策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id15">5.2 零信任原则</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id16">6. 性能优化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id17">6.1 缓存策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id18">6.2 连接池</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id19">6.3 重试策略</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id20">7. 可观测性</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id21">7.1 日志架构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id22">7.2 监控指标</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id23">7.3 请求追踪</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id24">8. 部署架构</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id25">8.1 部署架构图</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#docker-compose">8.2 容器化部署 (Docker Compose)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id26">8.3 本地开发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id27">8.4 生产部署</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id28">9. 扩展性设计</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id29">9.1 添加新模块</a></li>
<li class="toctree-l3"><a class="reference internal" href="../architecture.html#id30">9.2 添加新 Token 类型</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id31">10. 技术栈总结</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/token-monitoring.html">Token 过期监控 (Token Expiry Monitoring)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id1">概述</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#token">Token 类型说明</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id2">监控功能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id3">功能特性</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id4">多级通知机制</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id5">通知内容</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../features/token-monitoring.html#id6">预警通知 (7 天)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../features/token-monitoring.html#id7">严重警告 (3 天)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id8">配置监控参数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id9">手动检查 Token 状态</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id10">监控和可视化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#prometheus">Prometheus 指标</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#grafana">Grafana 面板</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id11">Prometheus 告警</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id12">Token 续期流程</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id13">在飞书开放平台续期</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id14">验证更新</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#api">API 参考</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#tokenexpirymonitor">TokenExpiryMonitor 类</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id15">最佳实践</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id16">1. 设置管理员通知</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id17">2. 定期检查监控面板</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id18">3. 提前续期</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id19">4. 建立续期流程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id20">5. 配置备用联系方式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id21">故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id22">未收到通知</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id23">通知发送失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/token-monitoring.html#id24">Prometheus 指标缺失</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/token-monitoring.html#id25">参考资料</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">测试与验证</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html">真实飞书环境集成验证指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id2">📋 验证清单</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id3">1. 配置真实飞书应用凭据</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id4">1.1 创建飞书应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id5">1.2 获取应用凭证</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id6">1.3 配置应用权限</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id7">消息与群组</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id8">通讯录</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id9">1.4 配置环境变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id10">1.5 重启服务</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#app-access-token">2. 验证 App Access Token 自动刷新</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id11">2.1 启动服务并观察日志</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#token">2.2 触发 Token 获取</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#prometheus">2.3 验证 Prometheus 指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#user-access-token-oauth">3. 验证 User Access Token OAuth 流程</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#oauth">3.1 配置 OAuth 回调</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id12">3.2 启动 OAuth 授权流程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id13">3.3 完成授权</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#user-access-token">3.4 交换 User Access Token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id14">4. 验证 Token 过期通知功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id15">4.1 手动触发 Token 过期检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id16">4.2 检查飞书消息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id17">4.3 验证 Prometheus 指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#grafana">5. 验证 Grafana 仪表板数据显示</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id18">5.1 访问 Grafana</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id19">5.2 导入仪表板</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id20">导入系统概览仪表板</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id21">导入 Token 监控仪表板</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#scheduler">导入 Scheduler 任务仪表板</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id22">5.3 验证数据显示</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id23">系统概览仪表板</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id24">Token 监控仪表板</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id25">Scheduler 任务仪表板</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id26">5.4 生成测试数据</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id27">6. 验证定时任务执行</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id28">6.1 查看 Scheduler 日志</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id29">6.2 验证任务执行频率</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id30">6.3 查看 Prometheus 指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id31">📊 完整验证报告</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id32">功能验证结果</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id33">性能指标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id34">🐛 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#q1-token">Q1: Token 刷新失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#q2">Q2: 收不到飞书通知</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#q3-grafana">Q3: Grafana 无数据</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing/INTEGRATION_VERIFICATION.html#id35">📝 下一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../TESTING-GUIDE.html">测试指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id2">📖 概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id3">🚀 快速开始</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id4">安装测试环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id5">运行测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id6">查看覆盖率</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id7">📋 覆盖率要求</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id8">整体要求</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id9">覆盖率阈值</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id10">模块覆盖率目标</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id11">🎯 测试编写指南</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id12">测试结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#mock">Mock策略</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id13">测试覆盖场景</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id14">📊 查看覆盖率报告</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#html">HTML报告</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id15">终端报告</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id16">🔧 常用命令</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id17">测试筛选</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id18">调试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id19">性能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id20">📝 测试命名规范</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id21">文件命名</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id22">类命名</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id23">方法命名</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#ci-cd">🎯 CI/CD集成</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#github-actions">GitHub Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id24">覆盖率检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id25">失败处理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id26">📚 参考资源</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#pytest">Pytest文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id27">项目示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TESTING-GUIDE.html#id28">❓ 常见问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#q">Q: 覆盖率不增加?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#q-mock-sdk">Q: 如何Mock SDK?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id29">Q: 测试太慢?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TESTING-GUIDE.html#id30">Q: 覆盖率如何提升?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integration-test-guide.html">集成测试指南</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id2">📋 测试分类</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#unit-tests">1. 单元测试 (Unit Tests)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#integration-tests">2. 集成测试 (Integration Tests)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id3">🔧 配置集成测试环境</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id4">步骤1: 创建配置文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id5">步骤2: 填写必需的配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id6">步骤3: 填写模块测试数据(可选)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#contact">Contact模块测试</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#clouddoc">CloudDoc模块测试</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id7">🚀 运行集成测试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id8">运行所有集成测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id9">运行特定模块的集成测试</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#id10">Contact模块</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#id11">CloudDoc模块</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#bitable">Bitable模块</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#sheet">Sheet模块</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id12">运行特定测试类</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id13">📊 当前测试状态</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id14">Contact模块 ✅</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#clouddoc-doc">CloudDoc - Doc客户端 ✅</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#clouddoc-bitable">CloudDoc - Bitable客户端 ⚠️</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#clouddoc-sheet">CloudDoc - Sheet客户端 ⚠️</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id15">🔑 权限要求</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id16">Contact模块权限</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id17">CloudDoc模块权限</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#id18">读操作</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integration-test-guide.html#id19">写操作(可选)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id20">📝 测试数据准备</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#token">获取测试Token</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id21">配置写权限测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id22">⚠️ 注意事项</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id23">🐛 故障排查</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id24">测试被跳过</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id25">认证失败</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id26">找不到资源</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration-test-guide.html#id27">Bitable测试失败</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration-test-guide.html#id28">📚 相关文档</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">发布说明</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases/v0.5.0.html">LarkService v0.5.0 发布说明</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id1">📅 发布信息</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id2">🎯 版本亮点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id3">1. ✅ 生产环境完整支持</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id4">2. 📊 监控与可观测性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id5">3. ⏰ 定时任务系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#token">4. 🔐 Token 管理优化</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id6">🚀 新功能</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#docker">Docker &amp; 容器化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id7">监控系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#apscheduler">APScheduler 定时任务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id8">Token 监控增强</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id9">🔧 改进与优化</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id10">架构改进</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id11">性能优化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id12">代码质量</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id13">📖 文档更新</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id14">新增文档</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id15">更新文档</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#breaking-changes">🔄 Breaking Changes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id16">⚠️ 重要变更</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../releases/v0.5.0.html#id17">1. Token 监控逻辑调整</a></li>
<li class="toctree-l4"><a class="reference internal" href="../releases/v0.5.0.html#id18">2. 环境变量新增</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#bug">🐛 Bug 修复</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id19">📦 依赖更新</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id20">新增依赖</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id21">更新依赖</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id22">🔍 已知问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id23">限制与待改进</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#v0-6-0">计划改进 (v0.6.0)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id24">🚀 快速开始</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id25">1. 克隆仓库</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id26">2. 配置环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id27">3. 启动服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id28">4. 验证部署</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id29">📊 统计数据</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id30">项目规模</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id31">功能模块</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id32">🙏 致谢</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id33">核心贡献者</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id34">特别感谢</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id35">📞 获取帮助</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id36">文档资源</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#id37">社区支持</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id38">🗺️ 未来规划</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#v0-6-0-2026-q2">v0.6.0 (2026-Q2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html#v0-7-0-2026-q3">v0.7.0 (2026-Q3)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../releases/v0.5.0.html#id39">📜 许可证</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Lark Service</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">lark_service.cardkit package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/lark_service.cardkit.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lark-service-cardkit-package">
<h1>lark_service.cardkit package<a class="headerlink" href="#lark-service-cardkit-package" title="Link to this heading"></a></h1>
<p>卡片服务 (CardKit) 提供了构建飞书交互式卡片的能力,支持预定义模板和自定义构建。</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-lark_service.cardkit.builder">
<span id="lark-service-cardkit-builder-module"></span><h2>lark_service.cardkit.builder module<a class="headerlink" href="#module-lark_service.cardkit.builder" title="Link to this heading"></a></h2>
<p>Card builder for Lark CardKit.</p>
<p>This module provides a builder for constructing interactive cards
with various templates and components.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.builder.CardBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.builder.</span></span><span class="sig-name descname"><span class="pre">CardBuilder</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.builder.CardBuilder" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Builder for constructing Lark interactive cards.</p>
<p>Provides methods for building cards with various templates and components,
including approval cards, notification cards, and form cards.</p>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">builder</span> <span class="o">=</span> <span class="n">CardBuilder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_approval_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Leave Request&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">applicant</span><span class="o">=</span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Annual Leave&quot;</span><span class="p">,</span> <span class="s2">&quot;Days&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">approve_action_id</span><span class="o">=</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reject_action_id</span><span class="o">=</span><span class="s2">&quot;reject_leave&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.builder.CardBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.builder.CardBuilder.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CardBuilder.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.builder.CardBuilder.build_card">
<span class="sig-name descname"><span class="pre">build_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">card_link</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.builder.CardBuilder.build_card" title="Link to this definition"></a></dt>
<dd><p>Build a custom card with specified components.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) -- Card header configuration</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>] </em><em>| </em><em>None</em>) -- List of card elements</p></li>
<li><p><strong>card_link</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) -- Card link configuration</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Complete card JSON structure</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InvalidParameterError</strong> -- If elements is empty</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">header</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Title&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="n">elements</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}}]</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.builder.CardBuilder.build_approval_card">
<span class="sig-name descname"><span class="pre">build_approval_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applicant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approve_action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reject_action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">note</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_approval_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.builder.CardBuilder.build_approval_card" title="Link to this definition"></a></dt>
<dd><p>Build an approval card template.</p>
<p>Creates a card with applicant info, detail fields, and approve/reject buttons.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Card title (e.g., &quot;Leave Request&quot;)</p></li>
<li><p><strong>applicant</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Applicant name</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>]</em>) -- Detail fields as key-value pairs (e.g., {&quot;Type&quot;: &quot;Annual Leave&quot;})</p></li>
<li><p><strong>approve_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID for approve button</p></li>
<li><p><strong>reject_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID for reject button</p></li>
<li><p><strong>note</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional note or description</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Approval card JSON structure</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_approval_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Leave Request&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">applicant</span><span class="o">=</span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Annual Leave&quot;</span><span class="p">,</span> <span class="s2">&quot;Days&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;Reason&quot;</span><span class="p">:</span> <span class="s2">&quot;Family trip&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">approve_action_id</span><span class="o">=</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reject_action_id</span><span class="o">=</span><span class="s2">&quot;reject_leave&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">note</span><span class="o">=</span><span class="s2">&quot;Please review and approve&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.builder.CardBuilder.build_notification_card">
<span class="sig-name descname"><span class="pre">build_notification_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'info'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_notification_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.builder.CardBuilder.build_notification_card" title="Link to this definition"></a></dt>
<dd><p>Build a notification card template.</p>
<p>Creates a simple notification card with optional action button.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Notification title</p></li>
<li><p><strong>content</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Notification content (supports markdown)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Notification level: &quot;info&quot;, &quot;warning&quot;, &quot;error&quot;, &quot;success&quot; (default: &quot;info&quot;)</p></li>
<li><p><strong>action_text</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action button text</p></li>
<li><p><strong>action_url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action button URL</p></li>
<li><p><strong>action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action button ID (for callback)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Notification card JSON structure</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;System Maintenance&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;The system will be down for maintenance on Jan 20.&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">action_text</span><span class="o">=</span><span class="s2">&quot;View Details&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">action_url</span><span class="o">=</span><span class="s2">&quot;https://example.com/maintenance&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.builder.CardBuilder.build_form_card">
<span class="sig-name descname"><span class="pre">build_form_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submit_action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancel_action_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_form_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.builder.CardBuilder.build_form_card" title="Link to this definition"></a></dt>
<dd><p>Build a form card template.</p>
<p>Creates a card with input fields and submit button.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Form title</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) -- List of form field configurations
Each field should have: {&quot;label&quot;: str, &quot;name&quot;: str, &quot;type&quot;: str, ...}</p></li>
<li><p><strong>submit_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID for submit button</p></li>
<li><p><strong>cancel_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action ID for cancel button</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Form card JSON structure</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_form_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Feedback Form&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;Your name&quot;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Feedback&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;feedback&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;textarea&quot;</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;Your feedback&quot;</span><span class="p">}</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="n">submit_action_id</span><span class="o">=</span><span class="s2">&quot;submit_feedback&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cancel_action_id</span><span class="o">=</span><span class="s2">&quot;cancel_feedback&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-lark_service.cardkit.callback_handler">
<span id="lark-service-cardkit-callback-handler-module"></span><h2>lark_service.cardkit.callback_handler module<a class="headerlink" href="#module-lark_service.cardkit.callback_handler" title="Link to this heading"></a></h2>
<p>Callback handler for Lark CardKit interactions.</p>
<p>This module provides functionality for handling card interaction callbacks,
including signature verification, URL verification, and event routing.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.callback_handler.</span></span><span class="sig-name descname"><span class="pre">CallbackHandler</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Handler for card interaction callbacks.</p>
<p>Provides methods for verifying callback signatures, handling URL verification,
and routing callback events to registered handlers.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.verification_token">
<span class="sig-name descname"><span class="pre">verification_token</span></span><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.verification_token" title="Link to this definition"></a></dt>
<dd><p>Lark app verification token</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.encrypt_key">
<span class="sig-name descname"><span class="pre">encrypt_key</span></span><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.encrypt_key" title="Link to this definition"></a></dt>
<dd><p>Optional encryption key for signature verification</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.handlers">
<span class="sig-name descname"><span class="pre">handlers</span></span><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.handlers" title="Link to this definition"></a></dt>
<dd><p>Registered callback handlers by action_id</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, Callable]</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">CallbackHandler</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">verification_token</span><span class="o">=</span><span class="s2">&quot;v_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">encrypt_key</span><span class="o">=</span><span class="s2">&quot;encrypt_xxx&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="n">handle_approve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_callback</span><span class="p">(</span><span class="n">request_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verification_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encrypt_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CallbackHandler.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verification_token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Lark app verification token</p></li>
<li><p><strong>encrypt_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional encryption key for signature verification</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.verify_signature">
<span class="sig-name descname"><span class="pre">verify_signature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonce</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.verify_signature"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.verify_signature" title="Link to this definition"></a></dt>
<dd><p>Verify callback request signature.</p>
<p>Uses HMAC-SHA256 to verify that the callback is from Lark.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request timestamp</p></li>
<li><p><strong>nonce</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request nonce</p></li>
<li><p><strong>body</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request body (raw JSON string)</p></li>
<li><p><strong>signature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request signature from header</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>bool</dt><dd><p>True if signature is valid, False otherwise</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_valid</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;1642512345&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nonce</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">body</span><span class="o">=</span><span class="s1">&#39;{&quot;type&quot;:&quot;url_verification&quot;}&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">signature</span><span class="o">=</span><span class="s2">&quot;sha256_signature_here&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.handle_url_verification">
<span class="sig-name descname"><span class="pre">handle_url_verification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">challenge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.handle_url_verification"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.handle_url_verification" title="Link to this definition"></a></dt>
<dd><p>Handle URL verification callback.</p>
<p>Lark sends this callback to verify the callback URL when configuring
card interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>challenge</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Challenge string from Lark</p></li>
<li><p><strong>token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Verification token from request</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, str]</dt><dd><p>Response with challenge</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValidationError</strong> -- If verification token doesn't match</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_url_verification</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">challenge</span><span class="o">=</span><span class="s2">&quot;challenge_string&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">token</span><span class="o">=</span><span class="s2">&quot;v_xxx&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;challenge&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.register_handler">
<span class="sig-name descname"><span class="pre">register_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.register_handler"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.register_handler" title="Link to this definition"></a></dt>
<dd><p>Register a callback handler for a specific action.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID to handle (e.g., &quot;approve_leave&quot;)</p></li>
<li><p><strong>handler</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#lark_service.cardkit.models.CallbackEvent" title="lark_service.cardkit.models.CallbackEvent"><em>CallbackEvent</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) -- Handler function that takes CallbackEvent and returns response</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">handle_approve</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CallbackEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="gp">... </span>    <span class="c1"># Process approval</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;approved&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="n">handle_approve</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.route_callback">
<span class="sig-name descname"><span class="pre">route_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.route_callback"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.route_callback" title="Link to this definition"></a></dt>
<dd><p>Route callback event to registered handler.</p>
<p>Extracts action_id from event and calls the corresponding handler.
If no handler is registered, returns a default success response.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- Callback event data from Lark</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Handler response or default response</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InvalidParameterError</strong> -- If event_data is invalid</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">route_callback</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;approve&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="s2">&quot;open_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ou_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;open_message_id&quot;</span><span class="p">:</span> <span class="s2">&quot;om_xxx&quot;</span>
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.callback_handler.CallbackHandler.handle_callback">
<span class="sig-name descname"><span class="pre">handle_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.handle_callback"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.callback_handler.CallbackHandler.handle_callback" title="Link to this definition"></a></dt>
<dd><p>Main entry point for handling card callbacks.</p>
<p>Handles both URL verification and card interaction callbacks.
Optionally verifies signature if timestamp, nonce, and signature are provided.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- Callback request data from Lark</p></li>
<li><p><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Request timestamp (for signature verification)</p></li>
<li><p><strong>nonce</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Request nonce (for signature verification)</p></li>
<li><p><strong>signature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Request signature (for signature verification)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Response to send back to Lark</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValidationError</strong> -- If signature verification fails or data is invalid</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># URL verification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_callback</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;url_verification&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;challenge&quot;</span><span class="p">:</span> <span class="s2">&quot;challenge_string&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="s2">&quot;v_xxx&quot;</span>
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Card interaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_callback</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">request_data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;card_action_trigger&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
<span class="gp">... </span>        <span class="o">...</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;1642512345&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nonce</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">signature</span><span class="o">=</span><span class="s2">&quot;sha256_signature&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-lark_service.cardkit.models">
<span id="lark-service-cardkit-models-module"></span><h2>lark_service.cardkit.models module<a class="headerlink" href="#module-lark_service.cardkit.models" title="Link to this heading"></a></h2>
<p>CardKit module data models.</p>
<p>This module defines Pydantic models for Lark CardKit operations,
including card configurations, elements, callback events, and related structures.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CardElementTag</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardElementTag"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Supported card element tags.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.HEADER">
<span class="sig-name descname"><span class="pre">HEADER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'header'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.HEADER" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.DIV">
<span class="sig-name descname"><span class="pre">DIV</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'div'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.DIV" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.ACTION">
<span class="sig-name descname"><span class="pre">ACTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'action'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.ACTION" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.HR">
<span class="sig-name descname"><span class="pre">HR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hr'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.HR" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.IMAGE">
<span class="sig-name descname"><span class="pre">IMAGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'image'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.IMAGE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.MARKDOWN">
<span class="sig-name descname"><span class="pre">MARKDOWN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'markdown'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.MARKDOWN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.FORM">
<span class="sig-name descname"><span class="pre">FORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'form'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.FORM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElementTag.__new__">
<span class="sig-name descname"><span class="pre">__new__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lark_service.cardkit.models.CardElementTag.__new__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardTemplateType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CardTemplateType</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardTemplateType"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardTemplateType" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Predefined card template types.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardTemplateType.APPROVAL">
<span class="sig-name descname"><span class="pre">APPROVAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'approval'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardTemplateType.APPROVAL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardTemplateType.NOTIFICATION">
<span class="sig-name descname"><span class="pre">NOTIFICATION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'notification'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardTemplateType.NOTIFICATION" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardTemplateType.FORM">
<span class="sig-name descname"><span class="pre">FORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'form'</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardTemplateType.FORM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardTemplateType.__new__">
<span class="sig-name descname"><span class="pre">__new__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lark_service.cardkit.models.CardTemplateType.__new__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CardElement</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardElement"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardElement" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Card element base model.</p>
<p>Represents a single element in a Lark interactive card.
Elements can be text, images, buttons, forms, etc.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElement.tag">
<span class="sig-name descname"><span class="pre">tag</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardElement.tag" title="Link to this definition"></a></dt>
<dd><p>Element tag (e.g., &quot;div&quot;, &quot;action&quot;, &quot;markdown&quot;)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">\*\*kwargs</span></span></dt>
<dd><p>Additional element-specific properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element</span> <span class="o">=</span> <span class="n">CardElement</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;div&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">text</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;lark_md&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;**Bold text**&quot;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">tag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardElement.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'extra':</span> <span class="pre">'allow'}</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardElement.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CardConfig</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardConfig"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardConfig" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Interactive card configuration.</p>
<p>Defines the structure and content of a Lark interactive card.
Cards consist of a header and a list of elements.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardConfig.header">
<span class="sig-name descname"><span class="pre">header</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardConfig.header" title="Link to this definition"></a></dt>
<dd><p>Card header configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardConfig.elements">
<span class="sig-name descname"><span class="pre">elements</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardConfig.elements" title="Link to this definition"></a></dt>
<dd><p>List of card elements (div, action, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardConfig.card_link">
<span class="sig-name descname"><span class="pre">card_link</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardConfig.card_link" title="Link to this definition"></a></dt>
<dd><p>Card link configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>]]</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">CardConfig</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">header</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Approval&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="n">elements</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;lark_md&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;**Name**: John&quot;</span><span class="p">}},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;button&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Approve&quot;</span><span class="p">}}]}</span>
<span class="gp">... </span>    <span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">header</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">elements</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]]</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">card_link</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">]</span> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardConfig.validate_elements_not_empty">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_elements_not_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardConfig.validate_elements_not_empty"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardConfig.validate_elements_not_empty" title="Link to this definition"></a></dt>
<dd><p>Validate that elements list is not empty.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span></p>
</dd>
<dt class="field-even">参数<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><em>Any</em></a><em>]</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CallbackEvent</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CallbackEvent"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Interactive card callback event.</p>
<p>Represents a callback event triggered by user interaction with a card.
Events are sent by Lark servers when users click buttons, submit forms, etc.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.event_type">
<span class="sig-name descname"><span class="pre">event_type</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.event_type" title="Link to this definition"></a></dt>
<dd><p>Event type (e.g., &quot;card.action.trigger&quot;)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.card_id">
<span class="sig-name descname"><span class="pre">card_id</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.card_id" title="Link to this definition"></a></dt>
<dd><p>Card ID</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.user_id">
<span class="sig-name descname"><span class="pre">user_id</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.user_id" title="Link to this definition"></a></dt>
<dd><p>User who triggered the action</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.action">
<span class="sig-name descname"><span class="pre">action</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.action" title="Link to this definition"></a></dt>
<dd><p>Action payload</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.signature">
<span class="sig-name descname"><span class="pre">signature</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.signature" title="Link to this definition"></a></dt>
<dd><p>Lark callback signature for verification</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.timestamp">
<span class="sig-name descname"><span class="pre">timestamp</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.timestamp" title="Link to this definition"></a></dt>
<dd><p>Event timestamp</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.app_id">
<span class="sig-name descname"><span class="pre">app_id</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.app_id" title="Link to this definition"></a></dt>
<dd><p>Application ID</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="n">CallbackEvent</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;card.action.trigger&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">user_id</span><span class="o">=</span><span class="s2">&quot;ou_a1b2c3d4e5f6g7h8&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">action</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;approve&quot;</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;button&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">signature</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;2026-01-15T10:30:00Z&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_a1b2c3d4e5f6g7h8&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">event_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">card_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">user_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">signature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">timestamp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">app_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.validate_signature_not_empty">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_signature_not_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CallbackEvent.validate_signature_not_empty"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.validate_signature_not_empty" title="Link to this definition"></a></dt>
<dd><p>Validate that signature is not empty.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
<dt class="field-even">参数<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackEvent.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lark_service.cardkit.models.CallbackEvent.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateRequest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CardUpdateRequest</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardUpdateRequest"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateRequest" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Card update request.</p>
<p>Used to update an existing card's content.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateRequest.message_id">
<span class="sig-name descname"><span class="pre">message_id</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateRequest.message_id" title="Link to this definition"></a></dt>
<dd><p>Message ID of the card to update</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateRequest.card_content">
<span class="sig-name descname"><span class="pre">card_content</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateRequest.card_content" title="Link to this definition"></a></dt>
<dd><p>New card content</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#lark_service.cardkit.models.CardConfig" title="lark_service.cardkit.models.CardConfig">CardConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateRequest.app_id">
<span class="sig-name descname"><span class="pre">app_id</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateRequest.app_id" title="Link to this definition"></a></dt>
<dd><p>Application ID</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">request</span> <span class="o">=</span> <span class="n">CardUpdateRequest</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">message_id</span><span class="o">=</span><span class="s2">&quot;om_a1b2c3d4e5f6g7h8&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">card_content</span><span class="o">=</span><span class="n">CardConfig</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_a1b2c3d4e5f6g7h8&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">message_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">card_content</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lark_service.cardkit.models.CardConfig" title="lark_service.cardkit.models.CardConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CardConfig</span></code></a></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">app_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateRequest.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateRequest.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CardUpdateResponse</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CardUpdateResponse"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateResponse" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Card update response for callback.</p>
<p>Used to return updated card content in response to a callback event.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateResponse.card">
<span class="sig-name descname"><span class="pre">card</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateResponse.card" title="Link to this definition"></a></dt>
<dd><p>Updated card JSON structure</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateResponse.toast">
<span class="sig-name descname"><span class="pre">toast</span></span><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateResponse.toast" title="Link to this definition"></a></dt>
<dd><p>Toast message to display to user</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>]]</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">CardUpdateResponse</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">card</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span> <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]},</span>
<span class="gp">... </span>    <span class="n">toast</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Approved successfully&quot;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">card</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">toast</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">]</span> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CardUpdateResponse.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lark_service.cardkit.models.CardUpdateResponse.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.models.</span></span><span class="sig-name descname"><span class="pre">CallbackHandler</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/models.html#CallbackHandler"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.models.CallbackHandler" title="Link to this definition"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Callback handler registration.</p>
<p>Defines a handler function for processing card callback events.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackHandler.event_type">
<span class="sig-name descname"><span class="pre">event_type</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackHandler.event_type" title="Link to this definition"></a></dt>
<dd><p>Event type to handle (e.g., &quot;card.action.trigger&quot;)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackHandler.action_value">
<span class="sig-name descname"><span class="pre">action_value</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackHandler.action_value" title="Link to this definition"></a></dt>
<dd><p>Specific action value to match (e.g., &quot;approve&quot;)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackHandler.handler_name">
<span class="sig-name descname"><span class="pre">handler_name</span></span><a class="headerlink" href="#lark_service.cardkit.models.CallbackHandler.handler_name" title="Link to this definition"></a></dt>
<dd><p>Name of the handler function</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">CallbackHandler</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;card.action.trigger&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">action_value</span><span class="o">=</span><span class="s2">&quot;approve&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">handler_name</span><span class="o">=</span><span class="s2">&quot;handle_approval&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">event_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">action_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">handler_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.models.CallbackHandler.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#lark_service.cardkit.models.CallbackHandler.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-lark_service.cardkit.updater">
<span id="lark-service-cardkit-updater-module"></span><h2>lark_service.cardkit.updater module<a class="headerlink" href="#module-lark_service.cardkit.updater" title="Link to this heading"></a></h2>
<p>Card updater for Lark CardKit.</p>
<p>This module provides functionality for updating interactive card content,
both proactively and in response to callbacks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.updater.CardUpdater">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.updater.</span></span><span class="sig-name descname"><span class="pre">CardUpdater</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.updater.CardUpdater" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Updater for interactive card content.</p>
<p>Provides methods for updating card content both proactively
(via API) and reactively (via callback responses).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.updater.CardUpdater.credential_pool">
<span class="sig-name descname"><span class="pre">credential_pool</span></span><a class="headerlink" href="#lark_service.cardkit.updater.CardUpdater.credential_pool" title="Link to this definition"></a></dt>
<dd><p>Credential pool for token management</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CredentialPool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.updater.CardUpdater.retry_strategy">
<span class="sig-name descname"><span class="pre">retry_strategy</span></span><a class="headerlink" href="#lark_service.cardkit.updater.CardUpdater.retry_strategy" title="Link to this definition"></a></dt>
<dd><p>Retry strategy for API calls</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>RetryStrategy</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">updater</span> <span class="o">=</span> <span class="n">CardUpdater</span><span class="p">(</span><span class="n">credential_pool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updater</span><span class="o">.</span><span class="n">update_card_content</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">message_id</span><span class="o">=</span><span class="s2">&quot;om_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">card_content</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span> <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.updater.CardUpdater.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">credential_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.updater.CardUpdater.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CardUpdater.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>credential_pool</strong> (<em>CredentialPool</em>) -- Credential pool for token management</p></li>
<li><p><strong>retry_strategy</strong> (<em>RetryStrategy</em><em> | </em><em>None</em>) -- Retry strategy (default: creates new instance)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.updater.CardUpdater.update_card_content">
<span class="sig-name descname"><span class="pre">update_card_content</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">card_content</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater.update_card_content"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.updater.CardUpdater.update_card_content" title="Link to this definition"></a></dt>
<dd><p>Update card content proactively via API.</p>
<p>Updates an existing card's content by calling Lark IM API.
The card must have been sent by the current app.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Lark application ID</p></li>
<li><p><strong>message_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Message ID of the card to update (e.g., &quot;om_xxx&quot;)</p></li>
<li><p><strong>card_content</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- New card content (header, elements, etc.)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Response containing success status</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>InvalidParameterError</strong> -- If message_id or card_content is empty</p></li>
<li><p><strong>RetryableError</strong> -- If update fails after retries</p></li>
</ul>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_card</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Updated&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}}]</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">updater</span><span class="o">.</span><span class="n">update_card_content</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">message_id</span><span class="o">=</span><span class="s2">&quot;om_abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">card_content</span><span class="o">=</span><span class="n">new_card</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.updater.CardUpdater.build_update_response">
<span class="sig-name descname"><span class="pre">build_update_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">card_content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toast_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater.build_update_response"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.updater.CardUpdater.build_update_response" title="Link to this definition"></a></dt>
<dd><p>Build a callback response to update card content.</p>
<p>Used in callback handlers to update the card that triggered the callback.
The response is returned to Lark servers, which will update the card.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>card_content</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- New card content (header, elements, etc.)</p></li>
<li><p><strong>toast_message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional toast message to show to user</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Callback response with card update</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InvalidParameterError</strong> -- If card_content is invalid</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a callback handler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">handle_approve</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CallbackEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="gp">... </span>    <span class="c1"># Update card to show approval status</span>
<span class="gp">... </span>    <span class="n">new_card</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Approved&quot;</span><span class="p">}},</span>
<span class="gp">... </span>        <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}}]</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">updater</span><span class="o">.</span><span class="n">build_update_response</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">card_content</span><span class="o">=</span><span class="n">new_card</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">toast_message</span><span class="o">=</span><span class="s2">&quot;Approval successful!&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-lark_service.cardkit">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lark_service.cardkit" title="Link to this heading"></a></h2>
<p>CardKit module for Lark Service.</p>
<p>This module provides interactive card capabilities including:
- Card building with flexible layouts
- Card callback handling
- Card content updates
- Pre-built card templates</p>
<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.CardBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.</span></span><span class="sig-name descname"><span class="pre">CardBuilder</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardBuilder" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Builder for constructing Lark interactive cards.</p>
<p>Provides methods for building cards with various templates and components,
including approval cards, notification cards, and form cards.</p>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">builder</span> <span class="o">=</span> <span class="n">CardBuilder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_approval_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Leave Request&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">applicant</span><span class="o">=</span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Annual Leave&quot;</span><span class="p">,</span> <span class="s2">&quot;Days&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">approve_action_id</span><span class="o">=</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reject_action_id</span><span class="o">=</span><span class="s2">&quot;reject_leave&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardBuilder.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CardBuilder.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardBuilder.build_card">
<span class="sig-name descname"><span class="pre">build_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">card_link</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardBuilder.build_card" title="Link to this definition"></a></dt>
<dd><p>Build a custom card with specified components.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) -- Card header configuration</p></li>
<li><p><strong>elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>] </em><em>| </em><em>None</em>) -- List of card elements</p></li>
<li><p><strong>card_link</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) -- Card link configuration</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Complete card JSON structure</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InvalidParameterError</strong> -- If elements is empty</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">header</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Title&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="n">elements</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}}]</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardBuilder.build_approval_card">
<span class="sig-name descname"><span class="pre">build_approval_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applicant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approve_action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reject_action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">note</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_approval_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardBuilder.build_approval_card" title="Link to this definition"></a></dt>
<dd><p>Build an approval card template.</p>
<p>Creates a card with applicant info, detail fields, and approve/reject buttons.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Card title (e.g., &quot;Leave Request&quot;)</p></li>
<li><p><strong>applicant</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Applicant name</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>]</em>) -- Detail fields as key-value pairs (e.g., {&quot;Type&quot;: &quot;Annual Leave&quot;})</p></li>
<li><p><strong>approve_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID for approve button</p></li>
<li><p><strong>reject_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID for reject button</p></li>
<li><p><strong>note</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional note or description</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Approval card JSON structure</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_approval_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Leave Request&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">applicant</span><span class="o">=</span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Annual Leave&quot;</span><span class="p">,</span> <span class="s2">&quot;Days&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;Reason&quot;</span><span class="p">:</span> <span class="s2">&quot;Family trip&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">approve_action_id</span><span class="o">=</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reject_action_id</span><span class="o">=</span><span class="s2">&quot;reject_leave&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">note</span><span class="o">=</span><span class="s2">&quot;Please review and approve&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardBuilder.build_notification_card">
<span class="sig-name descname"><span class="pre">build_notification_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'info'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_notification_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardBuilder.build_notification_card" title="Link to this definition"></a></dt>
<dd><p>Build a notification card template.</p>
<p>Creates a simple notification card with optional action button.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Notification title</p></li>
<li><p><strong>content</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Notification content (supports markdown)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Notification level: &quot;info&quot;, &quot;warning&quot;, &quot;error&quot;, &quot;success&quot; (default: &quot;info&quot;)</p></li>
<li><p><strong>action_text</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action button text</p></li>
<li><p><strong>action_url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action button URL</p></li>
<li><p><strong>action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action button ID (for callback)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Notification card JSON structure</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;System Maintenance&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;The system will be down for maintenance on Jan 20.&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">action_text</span><span class="o">=</span><span class="s2">&quot;View Details&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">action_url</span><span class="o">=</span><span class="s2">&quot;https://example.com/maintenance&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardBuilder.build_form_card">
<span class="sig-name descname"><span class="pre">build_form_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submit_action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancel_action_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/builder.html#CardBuilder.build_form_card"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardBuilder.build_form_card" title="Link to this definition"></a></dt>
<dd><p>Build a form card template.</p>
<p>Creates a card with input fields and submit button.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Form title</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.14）"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) -- List of form field configurations
Each field should have: {&quot;label&quot;: str, &quot;name&quot;: str, &quot;type&quot;: str, ...}</p></li>
<li><p><strong>submit_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID for submit button</p></li>
<li><p><strong>cancel_action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional action ID for cancel button</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Form card JSON structure</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_form_card</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Feedback Form&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;Your name&quot;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Feedback&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;feedback&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;textarea&quot;</span><span class="p">,</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;Your feedback&quot;</span><span class="p">}</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="n">submit_action_id</span><span class="o">=</span><span class="s2">&quot;submit_feedback&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cancel_action_id</span><span class="o">=</span><span class="s2">&quot;cancel_feedback&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.</span></span><span class="sig-name descname"><span class="pre">CallbackHandler</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Handler for card interaction callbacks.</p>
<p>Provides methods for verifying callback signatures, handling URL verification,
and routing callback events to registered handlers.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.verification_token">
<span class="sig-name descname"><span class="pre">verification_token</span></span><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.verification_token" title="Link to this definition"></a></dt>
<dd><p>Lark app verification token</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.encrypt_key">
<span class="sig-name descname"><span class="pre">encrypt_key</span></span><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.encrypt_key" title="Link to this definition"></a></dt>
<dd><p>Optional encryption key for signature verification</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.handlers">
<span class="sig-name descname"><span class="pre">handlers</span></span><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.handlers" title="Link to this definition"></a></dt>
<dd><p>Registered callback handlers by action_id</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）">str</a>, Callable]</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span> <span class="o">=</span> <span class="n">CallbackHandler</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">verification_token</span><span class="o">=</span><span class="s2">&quot;v_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">encrypt_key</span><span class="o">=</span><span class="s2">&quot;encrypt_xxx&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="n">handle_approve</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_callback</span><span class="p">(</span><span class="n">request_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verification_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encrypt_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CallbackHandler.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verification_token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Lark app verification token</p></li>
<li><p><strong>encrypt_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional encryption key for signature verification</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.verify_signature">
<span class="sig-name descname"><span class="pre">verify_signature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonce</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.verify_signature"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.verify_signature" title="Link to this definition"></a></dt>
<dd><p>Verify callback request signature.</p>
<p>Uses HMAC-SHA256 to verify that the callback is from Lark.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request timestamp</p></li>
<li><p><strong>nonce</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request nonce</p></li>
<li><p><strong>body</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request body (raw JSON string)</p></li>
<li><p><strong>signature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Request signature from header</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>bool</dt><dd><p>True if signature is valid, False otherwise</p>
</dd>
</dl>
</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_valid</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;1642512345&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nonce</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">body</span><span class="o">=</span><span class="s1">&#39;{&quot;type&quot;:&quot;url_verification&quot;}&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">signature</span><span class="o">=</span><span class="s2">&quot;sha256_signature_here&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.handle_url_verification">
<span class="sig-name descname"><span class="pre">handle_url_verification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">challenge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.handle_url_verification"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.handle_url_verification" title="Link to this definition"></a></dt>
<dd><p>Handle URL verification callback.</p>
<p>Lark sends this callback to verify the callback URL when configuring
card interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>challenge</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Challenge string from Lark</p></li>
<li><p><strong>token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Verification token from request</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, str]</dt><dd><p>Response with challenge</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValidationError</strong> -- If verification token doesn't match</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_url_verification</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">challenge</span><span class="o">=</span><span class="s2">&quot;challenge_string&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">token</span><span class="o">=</span><span class="s2">&quot;v_xxx&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;challenge&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.register_handler">
<span class="sig-name descname"><span class="pre">register_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.register_handler"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.register_handler" title="Link to this definition"></a></dt>
<dd><p>Register a callback handler for a specific action.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Action ID to handle (e.g., &quot;approve_leave&quot;)</p></li>
<li><p><strong>handler</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#lark_service.cardkit.models.CallbackEvent" title="lark_service.cardkit.models.CallbackEvent"><em>CallbackEvent</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) -- Handler function that takes CallbackEvent and returns response</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="（在 Python v3.14）"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">handle_approve</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CallbackEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="gp">... </span>    <span class="c1"># Process approval</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;approved&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">handler</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="n">handle_approve</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.route_callback">
<span class="sig-name descname"><span class="pre">route_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.route_callback"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.route_callback" title="Link to this definition"></a></dt>
<dd><p>Route callback event to registered handler.</p>
<p>Extracts action_id from event and calls the corresponding handler.
If no handler is registered, returns a default success response.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- Callback event data from Lark</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Handler response or default response</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InvalidParameterError</strong> -- If event_data is invalid</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">route_callback</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;approve&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="s2">&quot;open_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ou_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;open_message_id&quot;</span><span class="p">:</span> <span class="s2">&quot;om_xxx&quot;</span>
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CallbackHandler.handle_callback">
<span class="sig-name descname"><span class="pre">handle_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/callback_handler.html#CallbackHandler.handle_callback"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CallbackHandler.handle_callback" title="Link to this definition"></a></dt>
<dd><p>Main entry point for handling card callbacks.</p>
<p>Handles both URL verification and card interaction callbacks.
Optionally verifies signature if timestamp, nonce, and signature are provided.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- Callback request data from Lark</p></li>
<li><p><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Request timestamp (for signature verification)</p></li>
<li><p><strong>nonce</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Request nonce (for signature verification)</p></li>
<li><p><strong>signature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Request signature (for signature verification)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Response to send back to Lark</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValidationError</strong> -- If signature verification fails or data is invalid</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># URL verification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_callback</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;url_verification&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;challenge&quot;</span><span class="p">:</span> <span class="s2">&quot;challenge_string&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="s2">&quot;v_xxx&quot;</span>
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Card interaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">handle_callback</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">request_data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;card_action_trigger&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
<span class="gp">... </span>        <span class="o">...</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;1642512345&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nonce</span><span class="o">=</span><span class="s2">&quot;abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">signature</span><span class="o">=</span><span class="s2">&quot;sha256_signature&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lark_service.cardkit.CardUpdater">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lark_service.cardkit.</span></span><span class="sig-name descname"><span class="pre">CardUpdater</span></span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardUpdater" title="Link to this definition"></a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Updater for interactive card content.</p>
<p>Provides methods for updating card content both proactively
(via API) and reactively (via callback responses).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.CardUpdater.credential_pool">
<span class="sig-name descname"><span class="pre">credential_pool</span></span><a class="headerlink" href="#lark_service.cardkit.CardUpdater.credential_pool" title="Link to this definition"></a></dt>
<dd><p>Credential pool for token management</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CredentialPool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lark_service.cardkit.CardUpdater.retry_strategy">
<span class="sig-name descname"><span class="pre">retry_strategy</span></span><a class="headerlink" href="#lark_service.cardkit.CardUpdater.retry_strategy" title="Link to this definition"></a></dt>
<dd><p>Retry strategy for API calls</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>RetryStrategy</p>
</dd>
</dl>
</dd></dl>

<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">updater</span> <span class="o">=</span> <span class="n">CardUpdater</span><span class="p">(</span><span class="n">credential_pool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updater</span><span class="o">.</span><span class="n">update_card_content</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">message_id</span><span class="o">=</span><span class="s2">&quot;om_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">card_content</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span> <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardUpdater.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">credential_pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardUpdater.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize CardUpdater.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>credential_pool</strong> (<em>CredentialPool</em>) -- Credential pool for token management</p></li>
<li><p><strong>retry_strategy</strong> (<em>RetryStrategy</em><em> | </em><em>None</em>) -- Retry strategy (default: creates new instance)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardUpdater.update_card_content">
<span class="sig-name descname"><span class="pre">update_card_content</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">card_content</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater.update_card_content"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardUpdater.update_card_content" title="Link to this definition"></a></dt>
<dd><p>Update card content proactively via API.</p>
<p>Updates an existing card's content by calling Lark IM API.
The card must have been sent by the current app.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Lark application ID</p></li>
<li><p><strong>message_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a>) -- Message ID of the card to update (e.g., &quot;om_xxx&quot;)</p></li>
<li><p><strong>card_content</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- New card content (header, elements, etc.)</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Response containing success status</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>InvalidParameterError</strong> -- If message_id or card_content is empty</p></li>
<li><p><strong>RetryableError</strong> -- If update fails after retries</p></li>
</ul>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_card</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Updated&quot;</span><span class="p">}},</span>
<span class="gp">... </span>    <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}}]</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">updater</span><span class="o">.</span><span class="n">update_card_content</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">message_id</span><span class="o">=</span><span class="s2">&quot;om_abc123&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">card_content</span><span class="o">=</span><span class="n">new_card</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lark_service.cardkit.CardUpdater.build_update_response">
<span class="sig-name descname"><span class="pre">build_update_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">card_content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toast_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lark_service/cardkit/updater.html#CardUpdater.build_update_response"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#lark_service.cardkit.CardUpdater.build_update_response" title="Link to this definition"></a></dt>
<dd><p>Build a callback response to update card content.</p>
<p>Used in callback handlers to update the card that triggered the callback.
The response is returned to Lark servers, which will update the card.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>card_content</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) -- New card content (header, elements, etc.)</p></li>
<li><p><strong>toast_message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><em>str</em></a><em> | </em><em>None</em>) -- Optional toast message to show to user</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.14）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="（在 Python v3.14）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>dict[str, Any]</dt><dd><p>Callback response with card update</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InvalidParameterError</strong> -- If card_content is invalid</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">示例</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a callback handler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">handle_approve</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">CallbackEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="gp">... </span>    <span class="c1"># Update card to show approval status</span>
<span class="gp">... </span>    <span class="n">new_card</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Approved&quot;</span><span class="p">}},</span>
<span class="gp">... </span>        <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}}]</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">updater</span><span class="o">.</span><span class="n">build_update_response</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">card_content</span><span class="o">=</span><span class="n">new_card</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">toast_message</span><span class="o">=</span><span class="s2">&quot;Approval successful!&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="id19">
<h3>快速开始<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lark_service.cardkit.builder</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardBuilder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lark_service.messaging.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">MessagingClient</span>

<span class="c1"># 创建卡片构建器</span>
<span class="n">builder</span> <span class="o">=</span> <span class="n">CardBuilder</span><span class="p">()</span>

<span class="c1"># 构建通知卡片</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;系统通知&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;您有一条新消息待查看&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span>
<span class="p">)</span>

<span class="c1"># 发送卡片</span>
<span class="n">messaging_client</span> <span class="o">=</span> <span class="n">MessagingClient</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="n">credential_pool</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">messaging_client</span><span class="o">.</span><span class="n">send_card_message</span><span class="p">(</span>
    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
    <span class="n">receiver_id</span><span class="o">=</span><span class="s2">&quot;ou_xxx&quot;</span><span class="p">,</span>
    <span class="n">card</span><span class="o">=</span><span class="n">card</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id20">
<h3>通知卡片<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<p>四种通知级别:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 信息通知 (蓝色)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;构建成功&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;项目已成功构建&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span>
<span class="p">)</span>

<span class="c1"># 成功通知 (绿色)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;部署完成&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;✅ 应用已部署到生产环境&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;success&quot;</span>
<span class="p">)</span>

<span class="c1"># 警告通知 (橙色)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;资源告警&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;⚠️ CPU 使用率超过 80%&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span>
<span class="p">)</span>

<span class="c1"># 错误通知 (红色)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;部署失败&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;❌ 部署过程中发生错误&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;error&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3>审批卡片<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 请假申请审批</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_approval_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;请假申请&quot;</span><span class="p">,</span>
    <span class="n">applicant</span><span class="o">=</span><span class="s2">&quot;张三&quot;</span><span class="p">,</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;类型&quot;</span><span class="p">:</span> <span class="s2">&quot;年假&quot;</span><span class="p">,</span>
        <span class="s2">&quot;开始日期&quot;</span><span class="p">:</span> <span class="s2">&quot;2026-02-01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;结束日期&quot;</span><span class="p">:</span> <span class="s2">&quot;2026-02-03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;天数&quot;</span><span class="p">:</span> <span class="s2">&quot;3 天&quot;</span><span class="p">,</span>
        <span class="s2">&quot;原因&quot;</span><span class="p">:</span> <span class="s2">&quot;家庭旅行&quot;</span>
    <span class="p">},</span>
    <span class="n">approve_action_id</span><span class="o">=</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span>
    <span class="n">reject_action_id</span><span class="o">=</span><span class="s2">&quot;reject_leave&quot;</span><span class="p">,</span>
    <span class="n">note</span><span class="o">=</span><span class="s2">&quot;请审批&quot;</span>
<span class="p">)</span>

<span class="c1"># 发送给审批人</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">messaging_client</span><span class="o">.</span><span class="n">send_card_message</span><span class="p">(</span>
    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
    <span class="n">receiver_id</span><span class="o">=</span><span class="s2">&quot;ou_manager_xxx&quot;</span><span class="p">,</span>
    <span class="n">card</span><span class="o">=</span><span class="n">card</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id22">
<h3>表单卡片<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 反馈表单</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_form_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;用户反馈&quot;</span><span class="p">,</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;姓名&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;input&quot;</span><span class="p">,</span>
            <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;请输入您的姓名&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;反馈内容&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;feedback&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;textarea&quot;</span><span class="p">,</span>
            <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;请输入您的反馈&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="n">submit_action_id</span><span class="o">=</span><span class="s2">&quot;submit_feedback&quot;</span><span class="p">,</span>
    <span class="n">cancel_action_id</span><span class="o">=</span><span class="s2">&quot;cancel_feedback&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id23">
<h3>自定义卡片<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 使用 build_card 构建自定义卡片</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_card</span><span class="p">(</span>
    <span class="n">header</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;项目状态&quot;</span><span class="p">},</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span>
    <span class="p">},</span>
    <span class="n">elements</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># Markdown 文本</span>
        <span class="p">{</span>
            <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span>
            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;lark_md&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;**进度**: 85%</span><span class="se">\n</span><span class="s2">**预计完成**: 2026-02-15&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="c1"># 分割线</span>
        <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;hr&quot;</span><span class="p">},</span>
        <span class="c1"># 按钮组</span>
        <span class="p">{</span>
            <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;action&quot;</span><span class="p">,</span>
            <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;button&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;plain_text&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;查看详情&quot;</span><span class="p">},</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;primary&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;view_details&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3>卡片回调处理<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lark_service.cardkit.callback_handler</span><span class="w"> </span><span class="kn">import</span> <span class="n">CallbackHandler</span>

<span class="n">callback_handler</span> <span class="o">=</span> <span class="n">CallbackHandler</span><span class="p">(</span>
    <span class="n">verification_token</span><span class="o">=</span><span class="s2">&quot;your_verification_token&quot;</span><span class="p">,</span>
    <span class="n">encrypt_key</span><span class="o">=</span><span class="s2">&quot;your_encrypt_key&quot;</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">handle_approve</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;处理审批通过&quot;&quot;&quot;</span>
    <span class="c1"># 执行业务逻辑</span>
    <span class="n">approve_request</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># 返回更新后的卡片</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;toast&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;已批准&quot;</span><span class="p">},</span>
        <span class="s2">&quot;card&quot;</span><span class="p">:</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;审批结果&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;✅ 请假申请已批准&quot;</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="s2">&quot;success&quot;</span>
        <span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># 注册处理器</span>
<span class="n">callback_handler</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s2">&quot;approve_leave&quot;</span><span class="p">,</span> <span class="n">handle_approve</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id25">
<h3>卡片更新<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lark_service.cardkit.updater</span><span class="w"> </span><span class="kn">import</span> <span class="n">CardUpdater</span>

<span class="n">updater</span> <span class="o">=</span> <span class="n">CardUpdater</span><span class="p">(</span><span class="n">credential_pool</span><span class="o">=</span><span class="n">credential_pool</span><span class="p">)</span>

<span class="c1"># 更新已发送的卡片</span>
<span class="n">new_card</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_notification_card</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;状态更新&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="s2">&quot;任务已完成&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;success&quot;</span>
<span class="p">)</span>

<span class="n">updater</span><span class="o">.</span><span class="n">update_card_content</span><span class="p">(</span>
    <span class="n">app_id</span><span class="o">=</span><span class="s2">&quot;cli_xxx&quot;</span><span class="p">,</span>
    <span class="n">message_id</span><span class="o">=</span><span class="s2">&quot;om_xxx&quot;</span><span class="p">,</span>
    <span class="n">card_content</span><span class="o">=</span><span class="n">new_card</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../usage/card.html"><span class="doc">卡片服务</span></a> - 卡片服务完整使用指南</p></li>
<li><p><span class="xref std std-doc">lark_service.messaging</span> - 消息发送服务</p></li>
<li><p><a class="reference external" href="https://open.feishu.cn/document/ukTMukTMukTM/uczM3QjL3MzN04yNzcDN">飞书开放平台 - 消息卡片</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2026, Ray。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>