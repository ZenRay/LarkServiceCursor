{
  "errors": [],
  "generated_at": "2026-01-17T19:17:33Z",
  "metrics": {
    "_totals": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 6,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 12052,
      "nosec": 0,
      "skipped_tests": 21
    },
    "src/lark_service/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/apaas/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 28,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/apaas/client.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1029,
      "nosec": 0,
      "skipped_tests": 6
    },
    "src/lark_service/apaas/models.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 159,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cardkit/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cardkit/builder.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 363,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cardkit/callback_handler.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 316,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cardkit/models.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 186,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cardkit/updater.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 209,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cli/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 24,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/cli/app.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 302,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/clouddoc/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/clouddoc/bitable/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 3,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/clouddoc/bitable/client.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1024,
      "nosec": 0,
      "skipped_tests": 5
    },
    "src/lark_service/clouddoc/client.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 775,
      "nosec": 0,
      "skipped_tests": 5
    },
    "src/lark_service/clouddoc/models.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 377,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/clouddoc/sheet/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 3,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/clouddoc/sheet/client.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 837,
      "nosec": 0,
      "skipped_tests": 4
    },
    "src/lark_service/contact/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/contact/cache.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 351,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/contact/client.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 981,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/contact/models.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 214,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 50,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/config.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 147,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/credential_pool.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 5,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 357,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/exceptions.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 215,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/lock_manager.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 230,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/models/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 13,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/models/application.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 88,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/models/auth_session.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 110,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/models/token_storage.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 103,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/models/user_cache.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 97,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/response.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 113,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/retry.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 235,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/storage/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 11,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/storage/postgres_storage.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 362,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/core/storage/sqlite_storage.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 352,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/db/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 13,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/db/init_config_db.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 114,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/messaging/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/messaging/client.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 568,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/messaging/lifecycle.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 317,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/messaging/media_uploader.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 362,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/messaging/models.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 169,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/utils/__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 70,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/utils/logger.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 175,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/utils/masking.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 172,
      "nosec": 0,
      "skipped_tests": 0
    },
    "src/lark_service/utils/validators.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 428,
      "nosec": 0,
      "skipped_tests": 1
    }
  },
  "results": [
    {
      "code": "195         # Mask secret\n196         masked_secret = \"secret_****\"\n197 \n",
      "col_offset": 24,
      "end_col_offset": 37,
      "filename": "src/lark_service/cli/app.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'secret_****'",
      "line_number": 196,
      "line_range": [
        196
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "259 \n260     def get_token(\n261         self,\n262         app_id: str,\n263         token_type: str = \"app_access_token\",\n264         force_refresh: bool = False,\n265     ) -> str:\n266         \"\"\"Get token with automatic refresh.\n267 \n268         Args:\n269             app_id: Application ID\n270             token_type: Token type ('app_access_token' or 'tenant_access_token')\n271             force_refresh: Force token refresh even if not expired\n272 \n273         Returns:\n274             Token value\n275 \n276         Raises:\n277             AuthenticationError: If application not found or credentials invalid\n278             TokenAcquisitionError: If token acquisition fails\n279 \n280         Example:\n281             >>> pool = CredentialPool(config, app_manager, token_storage)\n282             >>> token = pool.get_token(\"cli_abc123\", \"app_access_token\")\n283         \"\"\"\n284         validate_app_id(app_id)\n285 \n286         if token_type not in [\"app_access_token\", \"tenant_access_token\"]:\n287             raise ValueError(\n288                 f\"Invalid token_type: {token_type}. \"\n289                 \"Must be 'app_access_token' or 'tenant_access_token'\"\n290             )\n291 \n292         # Check cache first (unless force_refresh)\n293         if not force_refresh:\n294             cached_token = self.token_storage.get_token(app_id, token_type)\n295             if cached_token and not cached_token.is_expired():\n296                 # Check if refresh is needed\n297                 if cached_token.should_refresh(threshold=self.config.token_refresh_threshold):\n298                     logger.info(\n299                         \"Token needs refresh\",\n300                         extra={\n301                             \"app_id\": app_id,\n302                             \"token_type\": token_type,\n303                             \"remaining_seconds\": cached_token.get_remaining_seconds(),\n304                         },\n305                     )\n306                     # Refresh in background (or synchronously if needed)\n307                     return self._refresh_token_internal(app_id, token_type, force=False)\n308                 else:\n309                     logger.debug(\n310                         \"Using cached token\",\n311                         extra={\n312                             \"app_id\": app_id,\n313                             \"token_type\": token_type,\n314                             \"remaining_seconds\": cached_token.get_remaining_seconds(),\n315                         },\n316                     )\n317                     return cached_token.token_value\n318 \n319         # Token not cached or expired, fetch new one\n320         return self._refresh_token_internal(app_id, token_type, force=force_refresh)\n321 \n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "src/lark_service/core/credential_pool.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'app_access_token'",
      "line_number": 260,
      "line_range": [
        260,
        261,
        262,
        263,
        264,
        265,
        266,
        267,
        268,
        269,
        270,
        271,
        272,
        273,
        274,
        275,
        276,
        277,
        278,
        279,
        280,
        281,
        282,
        283,
        284,
        285,
        286,
        287,
        288,
        289,
        290,
        291,
        292,
        293,
        294,
        295,
        296,
        297,
        298,
        299,
        300,
        301,
        302,
        303,
        304,
        305,
        306,
        307,
        308,
        309,
        310,
        311,
        312,
        313,
        314,
        315,
        316,
        317,
        318,
        319,
        320
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    },
    {
      "code": "321 \n322     def refresh_token(\n323         self,\n324         app_id: str,\n325         token_type: str = \"app_access_token\",\n326     ) -> str:\n327         \"\"\"Force refresh token from Feishu API (always fetches new token).\n328 \n329         Args:\n330             app_id: Application ID\n331             token_type: Token type ('app_access_token' or 'tenant_access_token')\n332 \n333         Returns:\n334             New token value\n335 \n336         Raises:\n337             AuthenticationError: If application not found or credentials invalid\n338             TokenAcquisitionError: If token acquisition fails\n339 \n340         Example:\n341             >>> pool = CredentialPool(config, app_manager, token_storage)\n342             >>> token = pool.refresh_token(\"cli_abc123\", \"app_access_token\")\n343         \"\"\"\n344         return self._refresh_token_internal(app_id, token_type, force=True)\n345 \n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "src/lark_service/core/credential_pool.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'app_access_token'",
      "line_number": 322,
      "line_range": [
        322,
        323,
        324,
        325,
        326,
        327,
        328,
        329,
        330,
        331,
        332,
        333,
        334,
        335,
        336,
        337,
        338,
        339,
        340,
        341,
        342,
        343,
        344
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    },
    {
      "code": "345 \n346     def _refresh_token_internal(\n347         self,\n348         app_id: str,\n349         token_type: str = \"app_access_token\",\n350         force: bool = False,\n351     ) -> str:\n352         \"\"\"Internal method to refresh token with optional force flag.\n353 \n354         Args:\n355             app_id: Application ID\n356             token_type: Token type\n357             force: If True, always fetch new token; if False, use double-check locking\n358 \n359         Returns:\n360             Token value\n361         \"\"\"\n362         validate_app_id(app_id)\n363 \n364         # Use lock to prevent concurrent refresh\n365         with RefreshLockContext(self.lock_manager, app_id, timeout=30.0):\n366             # Double-check cache after acquiring lock (unless force=True)\n367             if not force:\n368                 cached_token = self.token_storage.get_token(app_id, token_type)\n369                 # Check if token exists, not expired, and doesn't need refresh\n370                 if (\n371                     cached_token\n372                     and not cached_token.is_expired()\n373                     and not cached_token.should_refresh(\n374                         threshold=self.config.token_refresh_threshold\n375                     )\n376                 ):\n377                     # Token was refreshed by another process\n378                     logger.debug(\n379                         \"Token was refreshed by another process\",\n380                         extra={\"app_id\": app_id, \"token_type\": token_type},\n381                     )\n382                     return cached_token.token_value\n383 \n384             # Fetch new token with retry\n385             def fetch_token() -> tuple[str, datetime]:\n386                 if token_type == \"app_access_token\":\n387                     return self._fetch_app_access_token(app_id)\n388                 else:\n389                     return self._fetch_tenant_access_token(app_id)\n390 \n391             token_value, expires_at = self.retry_strategy.execute(fetch_token)\n392 \n393             # Store in database\n394             self.token_storage.set_token(\n395                 app_id=app_id,\n396                 token_type=token_type,\n397                 token_value=token_value,\n398                 expires_at=expires_at,\n399             )\n400 \n401             logger.info(\n402                 \"Token refreshed and stored\",\n403                 extra={\n404                     \"app_id\": app_id,\n405                     \"token_type\": token_type,\n406                     \"expires_at\": expires_at.isoformat(),\n407                 },\n408             )\n409 \n410             return token_value\n411 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "src/lark_service/core/credential_pool.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'app_access_token'",
      "line_number": 346,
      "line_range": [
        346,
        347,
        348,
        349,
        350,
        351,
        352,
        353,
        354,
        355,
        356,
        357,
        358,
        359,
        360,
        361,
        362,
        363,
        364,
        365,
        366,
        367,
        368,
        369,
        370,
        371,
        372,
        373,
        374,
        375,
        376,
        377,
        378,
        379,
        380,
        381,
        382,
        383,
        384,
        385,
        386,
        387,
        388,
        389,
        390,
        391,
        392,
        393,
        394,
        395,
        396,
        397,
        398,
        399,
        400,
        401,
        402,
        403,
        404,
        405,
        406,
        407,
        408,
        409,
        410
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    },
    {
      "code": "385             def fetch_token() -> tuple[str, datetime]:\n386                 if token_type == \"app_access_token\":\n387                     return self._fetch_app_access_token(app_id)\n",
      "col_offset": 33,
      "end_col_offset": 51,
      "filename": "src/lark_service/core/credential_pool.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'app_access_token'",
      "line_number": 386,
      "line_range": [
        386
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "411 \n412     def invalidate_token(\n413         self,\n414         app_id: str,\n415         token_type: str = \"app_access_token\",\n416     ) -> None:\n417         \"\"\"Invalidate cached token.\n418 \n419         Args:\n420             app_id: Application ID\n421             token_type: Token type\n422 \n423         Example:\n424             >>> pool = CredentialPool(config, app_manager, token_storage)\n425             >>> pool.invalidate_token(\"cli_abc123\", \"app_access_token\")\n426         \"\"\"\n427         validate_app_id(app_id)\n428 \n429         deleted = self.token_storage.delete_token(app_id, token_type)\n430 \n431         if deleted:\n432             logger.info(\n433                 \"Token invalidated\",\n434                 extra={\"app_id\": app_id, \"token_type\": token_type},\n435             )\n436         else:\n437             logger.debug(\n438                 \"Token not found for invalidation\",\n439                 extra={\"app_id\": app_id, \"token_type\": token_type},\n440             )\n441 \n",
      "col_offset": 4,
      "end_col_offset": 13,
      "filename": "src/lark_service/core/credential_pool.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'app_access_token'",
      "line_number": 412,
      "line_range": [
        412,
        413,
        414,
        415,
        416,
        417,
        418,
        419,
        420,
        421,
        422,
        423,
        424,
        425,
        426,
        427,
        428,
        429,
        430,
        431,
        432,
        433,
        434,
        435,
        436,
        437,
        438,
        439,
        440
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.2/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    }
  ]
}
