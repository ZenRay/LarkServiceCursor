# 技术债务管理指南

**版本**: 1.0.0
**更新时间**: 2026-01-15

---

## 定义与分类 (CHK126)

### 技术债务定义

技术债务是为了快速交付而做出的技术妥协,需要在未来偿还。

### 债务分类

| 类型 | 示例 | 优先级 | 偿还期限 |
|------|------|--------|---------|
| **架构债务** | 模块耦合过高 | P0 | 下一个 Sprint |
| **代码质量** | 重复代码 | P1 | 1个月内 |
| **测试债务** | 缺失的测试 | P1 | 1个月内 |
| **文档债务** | 缺失的 Docstring | P2 | 2个月内 |
| **性能债务** | 未优化的查询 | P2 | 按需处理 |

## 债务识别机制

### 自动识别

```bash
# 代码复杂度检查
radon cc src/ -a -nb

# 重复代码检测
pylint src/ --disable=all --enable=duplicate-code

# 测试覆盖率缺口
pytest --cov=src --cov-report=term-missing | grep "0%"

# 缺失的 Docstring
pydocstyle src/
```

### 手动识别

- Code Review 时标记 TODO/FIXME
- 性能分析发现的瓶颈
- 用户反馈的问题
- 定期技术债务评审会议

## 债务跟踪

### GitHub Issues 标签

```
Labels:
- tech-debt: 技术债务
- debt:architecture: 架构债务
- debt:testing: 测试债务
- debt:docs: 文档债务
- debt:performance: 性能债务

Priority:
- P0: 阻塞性,必须立即解决
- P1: 严重,1个月内解决
- P2: 一般,2个月内解决
- P3: 轻微,可延后
```

### Issue 模板

```markdown
## 债务描述
[简要描述技术债务]

## 债务类型
- [ ] 架构债务
- [ ] 代码质量
- [ ] 测试债务
- [ ] 文档债务
- [ ] 性能债务

## 产生原因
[为什么会产生这个债务]

## 影响范围
- 影响模块: [列出受影响的模块]
- 严重程度: [P0/P1/P2/P3]
- 当前规避方案: [如何暂时规避问题]

## 偿还计划
- [ ] 步骤 1: [具体行动]
- [ ] 步骤 2: [具体行动]
- 预计工作量: [X 人天]
- 截止日期: [YYYY-MM-DD]

## 偿还收益
[偿还后的好处]
```

## 当前债务清单

### Phase 1 识别的债务

| ID | 描述 | 类型 | 优先级 | 状态 |
|----| -----|------|--------|------|
| TD001 | init_config_db 测试覆盖率 20% | 测试 | P2 | Open |
| TD002 | PostgreSQL Storage 覆盖率 56% | 测试 | P2 | Open |
| TD003 | 部分工具函数缺少 Docstring | 文档 | P2 | Open |

### 偿还优先级

**P0 (立即)**: 无
**P1 (1个月)**: 无
**P2 (2个月)**: TD001, TD002, TD003
**P3 (延后)**: 无

## 偿还原则

1. **先还架构债**: 影响范围大,越拖越难
2. **测试债务优先**: 防止回归
3. **小步迭代**: 每个 Sprint 偿还 1-2 个债务
4. **记录决策**: 为什么产生,为什么这样还

---

**维护者**: Lark Service Team
